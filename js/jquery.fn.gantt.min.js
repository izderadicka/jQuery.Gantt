(function(a){a.fn.gantt=function(c){var g="jquery.fn.gantt";var f=["hours","days","weeks","months"];var d={source:null,itemsPerPage:7,months:["January","February","March","April","May","June","July","August","September","October","November","December"],dow:["S","M","T","W","T","F","S"],startPos:new Date(),navigate:"buttons",scale:"days",useCookie:false,maxScale:"months",minScale:"hours",waitText:"Please wait...",onItemClick:function(h){return},onAddClick:function(h){return},onRender:function(){return},scrollToToday:true};a.extend(a.expr[":"],{findday:function(j,n,h){var o=new Date(parseInt(h[3],10));var p=a(j).attr("id");p=p?p:"";var l=p.indexOf("-")+1;var k=new Date(parseInt(p.substring(l,p.length),10));o=new Date(o.getFullYear(),o.getMonth(),o.getDate());k=new Date(k.getFullYear(),k.getMonth(),k.getDate());return o.getTime()===k.getTime()}});a.extend(a.expr[":"],{findweek:function(j,n,h){var o=new Date(parseInt(h[3],10));var p=a(j).attr("id");p=p?p:"";var l=p.indexOf("-")+1;o=o.getFullYear()+"-"+o.getDayForWeek().getWeekOfYear();var k=p.substring(l,p.length);return o===k}});a.extend(a.expr[":"],{findmonth:function(j,n,h){var o=new Date(parseInt(h[3],10));o=o.getFullYear()+"-"+o.getMonth();var p=a(j).attr("id");p=p?p:"";var l=p.indexOf("-")+1;var k=p.substring(l,p.length);return o===k}});Date.prototype.getWeekId=function(){var j=this.getFullYear();var i=this.getDayForWeek().getWeekOfYear();var h=this.getMonth();if(h===11&&i===1){j++}return"dh-"+j+"-"+i};Date.prototype.genRepDate=function(){switch(d.scale){case"hours":return this.getTime();case"weeks":return this.getDayForWeek().getTime();case"months":return new Date(this.getFullYear(),this.getMonth(),1).getTime();default:return this.getTime()}};Date.prototype.getDayOfYear=function(){var h=new Date(this.getFullYear(),0,0);var i=new Date(this.getFullYear(),this.getMonth(),this.getDate());return Math.ceil((i-h)/86400000)};Date.prototype.getWeekOfYear=function(){var i=new Date(this.getFullYear(),0,1);var j=new Date(this.getFullYear(),this.getMonth(),this.getDate());if(i.getDay()>3){i=new Date(j.getFullYear(),0,(7-i.getDay()))}var h=j.getDayOfYear()-i.getDayOfYear();return Math.ceil(h/7)};Date.prototype.getDaysInMonth=function(){return 32-new Date(this.getFullYear(),this.getMonth(),32).getDate()};Date.prototype.hasWeek=function(){var i=new Date(this.valueOf());i.setDate(i.getDate()-i.getDay());var h=new Date(this.valueOf());h.setDate(h.getDate()+(6-h.getDay()));if(i.getMonth()===h.getMonth()){return true}else{return(i.getMonth()===this.getMonth()&&h.getDate()<4)||(i.getMonth()!==this.getMonth()&&h.getDate()>=4)}};Date.prototype.getDayForWeek=function(){var i=new Date(this.valueOf());i.setDate(i.getDate()-i.getDay());var h=new Date(this.valueOf());h.setDate(h.getDate()+(6-h.getDay()));if((i.getMonth()===h.getMonth())||(i.getMonth()!==h.getMonth()&&h.getDate()>=4)){return new Date(h.setDate(h.getDate()-3))}else{return new Date(i.setDate(i.getDate()+3))}};var b={elementFromPoint:function(h,i){if(a.browser.msie){h-=a(document).scrollLeft();i-=a(document).scrollTop()}else{h-=window.pageXOffset;i-=window.pageYOffset}return document.elementFromPoint(h,i)},create:function(h){if(typeof d.source!=="string"){h.data=d.source;b.init(h)}else{a.getJSON(d.source,function(i){h.data=i;b.init(h)})}},init:function(h){h.rowsNum=h.data.length;h.pageCount=Math.ceil(h.rowsNum/d.itemsPerPage);h.rowsOnLastPage=h.rowsNum-(Math.floor(h.rowsNum/d.itemsPerPage)*d.itemsPerPage);h.dateStart=e.getMinDate(h);h.dateEnd=e.getMaxDate(h);if(!h.dateStart||!h.dateEnd){return}b.waitToggle(h,true,function(){b.render(h)})},render:function(l){var n=a('<div class="fn-content"/>');var j=b.leftPanel(l);n.append(j);var k=b.rightPanel(l,j);var h,o;n.append(k);n.append(b.navigation(l));var i=k.find(".dataPanel");l.gantt=a('<div class="fn-gantt" />').append(n);a(l).html(l.gantt);l.scrollNavigation.panelMargin=parseInt(i.css("margin-left").replace("px",""),10);l.scrollNavigation.panelMaxPos=(i.width()-k.width());l.scrollNavigation.canScroll=(i.width()>k.width());b.markNow(l);b.fillData(l,i,j);if(d.useCookie){var p=a.cookie(this.cookieKey+"ScrollPos");if(p){l.hPosition=p}}if(d.scrollToToday){var m=Math.round((d.startPos/1000-l.dateStart/1000)/86400)-2;if((m>0&&l.hPosition!==0)){if(l.scaleOldWidth){h=(i.width()-k.width());o=h*l.hPosition/l.scaleOldWidth;o=o>0?0:o;i.css({"margin-left":o+"px"});l.scrollNavigation.panelMargin=o;l.hPosition=o;l.scaleOldWidth=null}else{i.css({"margin-left":l.hPosition+"px"});l.scrollNavigation.panelMargin=l.hPosition}b.repositionLabel(l)}else{b.repositionLabel(l)}}else{if((l.hPosition!==0)){if(l.scaleOldWidth){h=(i.width()-k.width());o=h*l.hPosition/l.scaleOldWidth;o=o>0?0:o;i.css({"margin-left":o+"px"});l.scrollNavigation.panelMargin=o;l.hPosition=o;l.scaleOldWidth=null}else{i.css({"margin-left":l.hPosition+"px"});l.scrollNavigation.panelMargin=l.hPosition}b.repositionLabel(l)}else{b.repositionLabel(l)}}i.css({height:j.height()});b.waitToggle(l,false);d.onRender()},leftPanel:function(j){var i=a('<div class="leftPanel"/>').append(a('<div class="row spacer"/>').css("height",e.getCellSize()*j.headerRows+"px").css("width","100%"));var h=[];a.each(j.data,function(k,l){if(k>=j.pageNum*d.itemsPerPage&&k<(j.pageNum*d.itemsPerPage+d.itemsPerPage)){h.push('<div class="row name row'+k+(l.desc?"":" fn-wide")+'" id="rowheader'+k+'" offset="'+k%d.itemsPerPage*e.getCellSize()+'">');h.push('<span class="fn-label'+(l.cssClass?" "+l.cssClass:"")+'">'+l.name+"</span>");h.push("</div>");if(l.desc){h.push('<div class="row desc row'+k+' " id="RowdId_'+k+'" data-id="'+l.id+'">');h.push('<span class="fn-label'+(l.cssClass?" "+l.cssClass:"")+'">'+l.desc+"</span>");h.push("</div>")}}});i.append(h.join(""));return i},dataPanel:function(j,k){var h=a('<div class="dataPanel" style="width: '+k+'px;"/>');b.maxOffset=k;var i=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";if(document.attachEvent){j.attachEvent("on"+i,function(l){b.wheelScroll(j,l)})}else{if(document.addEventListener){j.addEventListener(i,function(l){b.wheelScroll(j,l)},false)}}h.click(function(q){q.stopPropagation();var s,r;var o=a(j).find(".fn-gantt .leftPanel");var p=a(j).find(".fn-gantt .dataPanel");switch(d.scale){case"weeks":r=e.getCellSize()*2;break;case"months":r=e.getCellSize();break;case"hours":r=e.getCellSize()*2;break;case"days":r=e.getCellSize()*2;break;default:r=e.getCellSize()*2;break}var m=b.elementFromPoint(q.pageX,p.offset().top+r);if(m.className==="fn-label"){m=a(m.parentNode)}else{m=a(m)}var l=m.attr("repdate");var t=b.elementFromPoint(o.offset().left+o.width()-10,q.pageY);if(t.className.indexOf("fn-label")===0){t=a(t.parentNode)}else{t=a(t)}var n=t.data().id;d.onAddClick(l,n,m.attr("repdate"))});return h},rightPanel:function(j,F){var x=null;var A=[" sn"," wd"," wd"," wd"," wd"," wd"," sa"];var q=[" sn","","","","",""," sa"];var z=['<div class="row"/>'];var J=0;var y=['<div class="row"/>'];var h=-1;var t=[];var l=0;var E=[];var w=[];var H=new Date();H=new Date(H.getFullYear(),H.getMonth(),H.getDate());var k=d.holidays?d.holidays.join():"";switch(d.scale){case"hours":x=e.parseTimeRange(j.dateStart,j.dateEnd,j.scaleStep);var v=x[0].getFullYear();var I=x[0].getMonth();var D=x[0];for(var C=0;C<x.length;C++){var B=x[C];var u=B.getMonth();if(u!==I){y.push(('<div class="row header month" style="width: '+e.getCellSize()*h+'px"><div class="fn-label">'+d.months[I]+" "+o+"</div></div>"));I=u;h=0}h++;var o=B.getFullYear();if(o!==v){v=o;J=0}J++;var s=B.getDay();var p=D.getDay();var r=A[s];var G=D.getTime();if(k.indexOf((new Date(B.getFullYear(),B.getMonth(),B.getDate())).getTime())>-1){r="holiday"}if(s!==p){var n=(H-D===0)?" today":(k.indexOf(G)>-1)?"holiday":A[p];E.push('<div class="row day hours_scale'+n+'"  style="width: '+e.getCellSize()*l+'px;">  <div class="fn-label">'+D.getDate()+" "+d.dow[p]+"</div></div>");D=B;l=0}l++;w.push('<div class="row day '+r+'" id="dh-'+B.getTime()+'"  offset="'+C*e.getCellSize()+'"  repdate="'+B.genRepDate()+'"> '+B.getHours()+"</div>")}y.push('<div class="row header month" style="width: '+e.getCellSize()*h+'px"><div class="fn-label">'+d.months[I]+" "+v+"</div></div>");var r=A[D.getDay()];if(k.indexOf((new Date(D.getFullYear(),D.getMonth(),D.getDate())).getTime())>-1){r="holiday"}E.push('<div class="row day '+r+'"  style="width: '+e.getCellSize()*l+'px;">  <div class="fn-label">'+D.getDate()+" "+d.dow[D.getDay()]+"</div></div>");var m=b.dataPanel(j,x.length*e.getCellSize());m.append(y.join(""));m.append(a('<div class="row"/>').html(E.join("")));m.append(a('<div class="row"/>').html(w.join("")));break;case"weeks":x=e.parseWeeksRange(j.dateStart,j.dateEnd);z=['<div class="row"/>'];y=['<div class="row"/>'];var v=x[0].getFullYear();var I=x[0].getMonth();var D=x[0];for(var C=0;C<x.length;C++){var B=x[C];if(B.getFullYear()!==v){z.push(('<div class="row header year" style="width: '+e.getCellSize()*J+'px;"><div class="fn-label">'+v+"</div></div>"));v=B.getFullYear();J=0}J++;if(B.getMonth()!==I){y.push(('<div class="row header month" style="width:'+e.getCellSize()*h+'px;"><div class="fn-label">'+d.months[I]+"</div></div>"));I=B.getMonth();h=0}h++;t.push('<div class="row day wd"  id="'+B.getWeekId()+'" offset="'+C*e.getCellSize()+'" repdate="'+B.genRepDate()+'">  <div class="fn-label">'+B.getWeekOfYear()+"</div></div>")}z.push('<div class="row header year" style="width: '+e.getCellSize()*J+'px;"><div class="fn-label">'+v+"</div></div>");y.push('<div class="row header month" style="width: '+e.getCellSize()*h+'px"><div class="fn-label">'+d.months[I]+"</div></div>");var m=b.dataPanel(j,x.length*e.getCellSize());m.append(z.join("")+y.join("")+t.join("")+(E.join("")));break;case"months":x=e.parseMonthsRange(j.dateStart,j.dateEnd);var v=x[0].getFullYear();var I=x[0].getMonth();var D=x[0];for(var C=0;C<x.length;C++){var B=x[C];if(B.getFullYear()!==v){z.push(('<div class="row header year" style="width: '+e.getCellSize()*J+'px;"><div class="fn-label">'+v+"</div></div>"));v=B.getFullYear();J=0}J++;y.push('<div class="row day wd" id="dh-'+e.genId(B.getTime())+'" offset="'+C*e.getCellSize()+'" repdate="'+B.genRepDate()+'">'+(1+B.getMonth())+"</div>")}z.push('<div class="row header year" style="width: '+e.getCellSize()*J+'px;"><div class="fn-label">'+v+"</div></div>");y.push('<div class="row header month" style="width: '+e.getCellSize()*h+'px">"<div class="fn-label">'+d.months[I]+"</div></div>");var m=b.dataPanel(j,x.length*e.getCellSize());m.append(z.join(""));m.append(y.join(""));m.append(a('<div class="row"/>').html(t.join("")));m.append(a('<div class="row"/>').html(E.join("")));break;default:x=e.parseDateRange(j.dateStart,j.dateEnd);var v=x[0].getFullYear();var I=x[0].getMonth();var D=x[0];b.firstDay=x[1]||D;for(var C=0;C<x.length;C++){var B=x[C];if(B.getMonth()!==I){y.push(('<div class="row header month" style="width:'+e.getCellSize()*h+'px;"><div class="fn-label">'+d.months[I]+" "+v+"</div></div>"));I=B.getMonth();h=0}h++;if(B.getFullYear()!==v){v=B.getFullYear();J=0}J++;var p=B.getDay();var r=A[p];if(k.indexOf((new Date(B.getFullYear(),B.getMonth(),B.getDate())).getTime())>-1){r="holiday"}t.push('<div class="row date '+r+'"  id="dh-'+e.genId(B.getTime())+'" offset="'+C*e.getCellSize()+'" repdate="'+B.genRepDate()+'>  <div class="fn-label">'+B.getDate()+"</div></div>");E.push('<div class="row day '+r+'"  id="dw-'+e.genId(B.getTime())+'"  repdate="'+B.genRepDate()+'">  <div class="fn-label">'+d.dow[p]+"</div></div>")}y.push('<div class="row header month" style="width: '+e.getCellSize()*h+'px"><div class="fn-label">'+d.months[I]+" "+v+"</div></div>");var m=b.dataPanel(j,x.length*e.getCellSize());m.append(y.join(""));m.append(a('<div class="row"/>').html(t.join("")));m.append(a('<div class="row"/>').html(E.join("")));break}return a('<div class="rightPanel"></div>').append(m)},navigation:function(h){var i=null;if(d.navigate==="scroll"){i=a('<div class="navigate" />');if(h.pageCount>1){i.append(a('<div class="nav-slider-left" />').append(a('<span role="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){b.navigatePage(h,-1)})).append(a('<div class="page-number"/>').append(a("<span/>").html(h.pageNum+1+" of "+h.pageCount))).append(a('<span role="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){b.navigatePage(h,1)})))}i.append(a('<div class="nav-slider-bar" />').append(a('<a class="nav-slider-button" />')).mousedown(function(j){if(j.preventDefault){j.preventDefault()}h.scrollNavigation.scrollerMouseDown=true;b.sliderScroll(h,j)}).mousemove(function(j){if(h.scrollNavigation.scrollerMouseDown){b.sliderScroll(h,j)}})).append(a('<div class="nav-slider-right" />').append(a('<span role="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){b.zoomInOut(h,-1)})).append(a('<span role="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){b.zoomInOut(h,1)})));a(document).mouseup(function(){h.scrollNavigation.scrollerMouseDown=false})}else{if(d.navigate==="buttons_limited"){i=a('<div class="navigate" />');if(h.pageCount>1){i.append(a('<div class="nav-slider-left" />').append(a('<span role="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){b.navigatePage(h,-1)})).append(a('<div class="page-number"/>').append(a("<span/>").html(h.pageNum+1+" of "+h.pageCount))).append(a('<span role="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){b.navigatePage(h,1)})))}i.append(a('<span role="button" class="nav-link nav-begin"/>').html("&#124;&lt;").click(function(){b.navigateTo(h,"begin")})).append(a('<span role="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){b.navigateTo(h,e.getCellSize()*12)})).append(a('<span role="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){b.navigateTo(h,e.getCellSize()*-12)})).append(a('<span role="button" class="nav-link nav-end"/>').html("&gt;&#124;").click(function(){b.navigateTo(h,"end")})).append(a('<div class="nav-slider-right" />').append(a('<span role="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){b.zoomInOut(h,-1)})).append(a('<span role="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){b.zoomInOut(h,1)})))}else{i=a('<div class="navigate" />').append(a('<span role="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){b.navigatePage(h,-1)})).append(a('<div class="page-number"/>').append(a("<span/>").html(h.pageNum+1+" of "+h.pageCount))).append(a('<span role="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){b.navigatePage(h,1)})).append(a('<span role="button" class="nav-link nav-begin"/>').html("&#124;&lt;").click(function(){b.navigateTo(h,"begin")})).append(a('<span role="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){b.navigateTo(h,e.getCellSize()*7)})).append(a('<span role="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){b.navigateTo(h,e.getCellSize())})).append(a('<span role="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){b.navigateTo(h,"now")})).append(a('<span role="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){b.navigateTo(h,e.getCellSize()*-1)})).append(a('<span role="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){b.navigateTo(h,e.getCellSize()*-7)})).append(a('<span role="button" class="nav-link nav-end"/>').html("&gt;&#124;").click(function(){b.navigateTo(h,"end")})).append(a('<span role="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){b.zoomInOut(h,-1)})).append(a('<span role="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){b.zoomInOut(h,1)}))}}return a('<div class="bottom"/>').append(i)},createProgressBar:function(o,h,n,j,i){var k=e.getCellSize();var m=e.getProgressBarMargin()||0;var l=a('<div class="bar"><div class="fn-label">'+j+"</div></div>").addClass(h).css({width:((k*o)-m)+5}).data("dataObj",i);if(n){l.mouseover(function(p){var q=a('<div class="fn-gantt-hint" />').html(n);a("body").append(q);q.css("left",p.pageX);q.css("top",p.pageY);q.show()}).mouseout(function(){a(".fn-gantt-hint").remove()}).mousemove(function(p){a(".fn-gantt-hint").css("left",p.pageX);a(".fn-gantt-hint").css("top",p.pageY+15)})}l.click(function(p){p.stopPropagation();d.onItemClick(a(this).data("dataObj"))});return l},markNow:function(h){switch(d.scale){case"weeks":var i=Date.parse(new Date());i=(Math.floor(i/36400000)*36400000);a(h).find(':findweek("'+i+'")').removeClass("wd").addClass("today");break;case"months":a(h).find(':findmonth("'+new Date().getTime()+'")').removeClass("wd").addClass("today");break;default:var i=Date.parse(new Date());i=(Math.floor((i+36400000)/36400000)*36400000);a(h).find(':findday("'+i+'")').removeClass("wd").addClass("today");break}},fillData:function(h,i,j){var k=function(p){try{p=p.replace("rgb(","").replace(")","");var r=p.split(",");var n=parseInt(r[0],10);var m=parseInt(r[1],10);var q=parseInt(r[2],10);var l=Math.round((255-(0.299*n+0.587*m+0.114*q))*0.9,1);return"rgb("+l+", "+l+", "+l+")"}catch(o){return""}};a.each(h.data,function(l,m){if(l>=h.pageNum*d.itemsPerPage&&l<(h.pageNum*d.itemsPerPage+d.itemsPerPage)){a.each(m.values,function(z,A){var E=null;switch(d.scale){case"hours":var C=e.getCellSize()/(3600*h.scaleStep);var r=e.dateDeserialize(A.from).getTime();var v=e.genId(r,h.scaleStep);var w=a(h).find("#dh-"+v);var p=e.dateDeserialize(A.to).getTime();var t=e.genId(p,h.scaleStep);var o=a(h).find("#dh-"+t);var n=parseInt(w.attr("offset"))-e.getCellSize()+Math.round(C*(r-v)/1000);if(isNaN(n)){n=0}var F=parseInt(o.attr("offset"))-e.getCellSize()+Math.round(C*(p-t)/1000);if(isNaN(F)){F=b.maxOffset}var y=(F-n)/e.getCellSize();E=b.createProgressBar(y,A.customClass?A.customClass:"",A.desc?A.desc:"",A.label?A.label:"",A.dataObj?A.dataObj:null);var q=a(h).find("#rowheader"+l);var u=e.getCellSize()*3+2+parseInt(q.attr("offset"),10);E.css({"margin-top":u,"margin-left":Math.floor(n)});i.append(E);break;case"weeks":var x=e.dateDeserialize(A.from);var s=e.dateDeserialize(A.to);if(x.getDate()<=3&&x.getMonth()===0){x.setDate(x.getDate()+4)}if(x.getDate()<=3&&x.getMonth()===0){x.setDate(x.getDate()+4)}if(s.getDate()<=3&&s.getMonth()===0){s.setDate(s.getDate()+4)}var w=a(h).find("#"+x.getWeekId());var n=w.attr("offset");var o=a(h).find("#"+s.getWeekId());var F=o.attr("offset");var y=Math.round((F-n)/e.getCellSize())+1;E=b.createProgressBar(y,A.customClass?A.customClass:"",A.desc?A.desc:"",A.label?A.label:"",A.dataObj?A.dataObj:null);var q=a(h).find("#rowheader"+l);var u=e.getCellSize()*3+2+parseInt(q.attr("offset"),10);E.css({"margin-top":u,"margin-left":Math.floor(n)});i.append(E);break;case"months":var x=e.dateDeserialize(A.from);var s=e.dateDeserialize(A.to);if(x.getDate()<=3&&x.getMonth()===0){x.setDate(x.getDate()+4)}if(x.getDate()<=3&&x.getMonth()===0){x.setDate(x.getDate()+4)}if(s.getDate()<=3&&s.getMonth()===0){s.setDate(s.getDate()+4)}var w=a(h).find("#dh-"+e.genId(x.getTime()));var n=w.attr("offset");var o=a(h).find("#dh-"+e.genId(s.getTime()));var F=o.attr("offset");var y=Math.round((F-n)/e.getCellSize())+1;E=b.createProgressBar(y,A.customClass?A.customClass:"",A.desc?A.desc:"",A.label?A.label:"",A.dataObj?A.dataObj:null);var q=a(h).find("#rowheader"+l);var u=e.getCellSize()*2+2+parseInt(q.attr("offset"),10);E.css({"margin-top":u,"margin-left":Math.floor(n)});i.append(E);break;default:var v=e.genId(e.dateDeserialize(A.from).getTime());var t=e.genId(e.dateDeserialize(A.to).getTime());var w=a(h).find("#dh-"+v);var n=w.attr("offset")-e.getCellSize();if(isNaN(n)){n=0;v=b.firstDay}var y=Math.floor(((t/1000)-(v/1000))/86400)+1;if(y*e.getCellSize()+n>b.maxOffset){y=Math.floor((b.maxOffset-n)/e.getCellSize())}E=b.createProgressBar(y,A.customClass?A.customClass:"",A.desc?A.desc:"",A.label?A.label:"",A.dataObj?A.dataObj:null);var q=a(h).find("#rowheader"+l);var u=e.getCellSize()*3+2+parseInt(q.attr("offset"),10);E.css({"margin-top":u,"margin-left":Math.floor(n)});i.append(E);break}var D=E.find(".fn-label");if(D&&E.length){var B=k(E[0].style.backgroundColor);D.css("color",B)}else{if(D){D.css("color","")}}})}})},navigateTo:function(m,j){var k=a(m).find(".fn-gantt .rightPanel");var h=k.find(".dataPanel");h.click=function(){alert(arguments.join(""))};var n=k.width();var l=h.width();switch(j){case"begin":h.animate({"margin-left":"0px"},"fast",function(){b.repositionLabel(m)});m.scrollNavigation.panelMargin=0;break;case"end":var i=l-n;m.scrollNavigation.panelMargin=i*-1;h.animate({"margin-left":"-"+i+"px"},"fast",function(){b.repositionLabel(m)});break;case"now":if(!m.scrollNavigation.canScroll||!h.find(".today").length){return false}var o=(l-n)*-1;var p=h.css("margin-left").replace("px","");var j=h.find(".today").offset().left-h.offset().left;j*=-1;if(j>0){j=0}else{if(j<o){j=o}}h.animate({"margin-left":j+"px"},"fast",b.repositionLabel(m));m.scrollNavigation.panelMargin=j;break;default:var o=n-l;var p=h.css("margin-left").replace("px","");var j=parseInt(p,10)+j;if(j>0){j=0}else{if(j<o){j=o}}if(j<=0&&j>=o){h.animate({"margin-left":j+"px"},"fast",b.repositionLabel(m))}m.scrollNavigation.panelMargin=j;break}},navigatePage:function(h,i){if((h.pageNum+i)>=0&&(h.pageNum+i)<Math.ceil(h.rowsNum/d.itemsPerPage)){b.waitToggle(h,true,function(){h.pageNum+=i;h.hPosition=a(".fn-gantt .dataPanel").css("margin-left").replace("px","");h.scaleOldWidth=false;b.init(h)})}},zoomInOut:function(h,i){b.waitToggle(h,true,function(){var o=(i<0);var m=h.scaleStep+i*3;m=m<=1?1:m===4?3:m;var l=d.scale;var j=h.headerRows;if(d.scale==="hours"&&m>=13){l="days";j=3;m=13}else{if(d.scale==="days"&&o){l="hours";j=3;m=12}else{if(d.scale==="days"&&!o){l="weeks";j=3;m=13}else{if(d.scale==="weeks"&&!o){l="months";j=2;m=14}else{if(d.scale==="weeks"&&o){l="days";j=3;m=13}else{if(d.scale==="months"&&o){l="weeks";j=3;m=13}}}}}}if((o&&a.inArray(l,f)<a.inArray(d.minScale,f))||(!o&&a.inArray(l,f)>a.inArray(d.maxScale,f))){b.init(h);return}h.scaleStep=m;d.scale=l;h.headerRows=j;var k=a(h).find(".fn-gantt .rightPanel");var n=k.find(".dataPanel");h.hPosition=n.css("margin-left").replace("px","");h.scaleOldWidth=(n.width()-k.width());if(d.useCookie){a.cookie(this.cookieKey+"CurrentScale",d.scale);a.cookie(this.cookieKey+"ScrollPos",null)}b.init(h)})},mouseScroll:function(h,i){var m=a(h).find(".fn-gantt .dataPanel");m.css("cursor","move");var k=m.offset();var j=h.scrollNavigation.mouseX===null?i.pageX:h.scrollNavigation.mouseX;var l=i.pageX-j;h.scrollNavigation.mouseX=i.pageX;b.scrollPanel(h,l);clearTimeout(h.scrollNavigation.repositionDelay);h.scrollNavigation.repositionDelay=setTimeout(b.repositionLabel,50,h)},wheelScroll:function(h,i){var j=i.detail?i.detail*(-50):i.wheelDelta/120*50;b.scrollPanel(h,j);clearTimeout(h.scrollNavigation.repositionDelay);h.scrollNavigation.repositionDelay=setTimeout(b.repositionLabel,50,h);if(i.preventDefault){i.preventDefault()}else{return false}},sliderScroll:function(m,o){var r=a(m).find(".nav-slider-bar");var q=r.find(".nav-slider-button");var l=a(m).find(".fn-gantt .rightPanel");var i=l.find(".dataPanel");var j=r.offset();var s=r.width();var k=q.width();var p,h;if((o.pageX>=j.left)&&(o.pageX<=j.left+s)){p=o.pageX-j.left;p=p-k/2;q.css("left",p);h=i.width()-l.width();var n=p*h/s*-1;if(n>=0){i.css("margin-left","0px");m.scrollNavigation.panelMargin=0}else{if(p>=s-(k*1)){i.css("margin-left",h*-1+"px");m.scrollNavigation.panelMargin=h*-1}else{i.css("margin-left",n+"px");m.scrollNavigation.panelMargin=n}}clearTimeout(m.scrollNavigation.repositionDelay);m.scrollNavigation.repositionDelay=setTimeout(b.repositionLabel,5,m)}},scrollPanel:function(h,j){if(!h.scrollNavigation.canScroll){return false}var i=parseInt(h.scrollNavigation.panelMargin,10)+j;if(i>0){h.scrollNavigation.panelMargin=0;a(h).find(".fn-gantt .dataPanel").css("margin-left",h.scrollNavigation.panelMargin+"px")}else{if(i<h.scrollNavigation.panelMaxPos*-1){h.scrollNavigation.panelMargin=h.scrollNavigation.panelMaxPos*-1;a(h).find(".fn-gantt .dataPanel").css("margin-left",h.scrollNavigation.panelMargin+"px")}else{h.scrollNavigation.panelMargin=i;a(h).find(".fn-gantt .dataPanel").css("margin-left",h.scrollNavigation.panelMargin+"px")}}b.synchronizeScroller(h)},synchronizeScroller:function(l){if(d.navigate==="scroll"){var k=a(l).find(".fn-gantt .rightPanel");var h=k.find(".dataPanel");var p=a(l).find(".nav-slider-bar");var m=p.find(".nav-slider-button");var q=p.width();var j=m.width();var i=h.width()-k.width();var n=0;if(h.css("margin-left")){n=h.css("margin-left").replace("px","")}var o=n*q/i-m.width()*0.25;o=o>0?0:(o*-1>=q-(j*0.75))?(q-(j*1.25))*-1:o;m.css("left",o*-1)}},repositionLabel:function(h){setTimeout(function(){var j;if(!h){j=a(".fn-gantt .rightPanel .dataPanel")}else{var i=a(h).find(".fn-gantt .rightPanel");j=i.find(".dataPanel")}if(d.useCookie){a.cookie(this.cookieKey+"ScrollPos",j.css("margin-left").replace("px",""))}},500)},waitToggle:function(j,h,l){if(h){var i=a(j).offset();var k=a(j).outerWidth();var m=a(j).outerHeight();if(!j.loader){j.loader=a('<div class="fn-gantt-loader" style="position: absolute; top: '+i.top+"px; left: "+i.left+"px; width: "+k+"px; height: "+m+'px;"><div class="fn-gantt-loader-spinner"><span>'+d.waitText+"</span></div></div>")}a("body").append(j.loader);setTimeout(l,100)}else{if(j.loader){j.loader.remove()}j.loader=null}}};var e={getMaxDate:function(h){var k=null;if(d.endDate){k=new Date(d.endDate)}else{a.each(h.data,function(l,m){a.each(m.values,function(o,n){k=k<e.dateDeserialize(n.to)?e.dateDeserialize(n.to):k})})}if(!k){return}switch(d.scale){case"hours":k.setHours(Math.ceil((k.getHours())/h.scaleStep)*h.scaleStep);k.setHours(k.getHours());break;case"weeks":var j=new Date(k.getTime());var j=new Date(j.setDate(j.getDate()));var i=Math.floor(j.getDate()/7)*7;k=new Date(j.getFullYear(),j.getMonth(),i===0?4:i-3);break;case"months":var j=new Date(k.getFullYear(),k.getMonth(),1);j.setMonth(j.getMonth());k=new Date(j.getFullYear(),j.getMonth(),1);break;default:k.setHours(0);k.setDate(k.getDate());break}return k},getMinDate:function(h){var k=null;if(d.startDate){k=new Date(d.startDate)}else{a.each(h.data,function(l,m){a.each(m.values,function(o,n){k=k>e.dateDeserialize(n.from)||k===null?e.dateDeserialize(n.from):k})})}if(!k){return}switch(d.scale){case"hours":k.setHours(Math.floor((k.getHours())/h.scaleStep)*h.scaleStep);k.setHours(k.getHours()-h.scaleStep*1);k=new Date(k.getFullYear(),k.getMonth(),k.getDate(),k.getHours());break;case"weeks":var j=new Date(k.getTime());var j=new Date(j.setDate(j.getDate()-1*7));var i=Math.floor(j.getDate()/7)*7;k=new Date(j.getFullYear(),j.getMonth(),i===0?4:i-3);break;case"months":var j=new Date(k.getFullYear(),k.getMonth(),1);j.setMonth(j.getMonth()-1);k=new Date(j.getFullYear(),j.getMonth(),1);break;default:k.setHours(0);k.setDate(k.getDate()-1);break}return k},parseDateRange:function(n,m){var l=new Date(n.getTime());var h=new Date(m.getTime());var j=[];var k=0;do{j[k++]=new Date(l.getTime());l.setDate(l.getDate()+1)}while(l.getTime()<=m.getTime());return j},parseTimeRange:function(o,n,j){var m=new Date(o);var h=new Date(n);var k=[];var l=0;do{k[l]=new Date(m.getTime());m.setHours(m.getHours()+j);m.setHours(Math.floor((m.getHours())/j)*j);if(m.getDay()!==k[l].getDay()){m.setHours(0)}l++}while(m.getTime()<=n.getTime());return k},parseWeeksRange:function(n,m){var l=new Date(n);var h=new Date(m);var j=[];var k=0;do{if(l.getDay()===0){j[k++]=l.getDayForWeek()}l.setDate(l.getDate()+1)}while(l.getTime()<=m.getTime());return j},parseMonthsRange:function(n,m){var l=new Date(n);var h=new Date(m);var j=[];var k=0;do{j[k++]=new Date(l.getFullYear(),l.getMonth(),1);l.setMonth(l.getMonth()+1)}while(l.getTime()<=m.getTime());return j},dateDeserialize:function(h){var i=new Date(parseInt(h.substring(6)));return i},genId:function(l){var k=new Date(l);switch(d.scale){case"hours":var j=k.getHours();if(arguments.length>=2){j=(Math.floor((k.getHours())/arguments[1])*arguments[1])}return(new Date(k.getFullYear(),k.getMonth(),k.getDate(),j)).getTime();case"weeks":var n=k.getFullYear();var i=k.getDayForWeek().getWeekOfYear();var h=k.getMonth();if(h===11&&i===1){n++}return n+"-"+i;case"months":return k.getFullYear()+"-"+k.getMonth();default:return(new Date(k.getFullYear(),k.getMonth(),k.getDate())).getTime()}},_getCellSize:null,getCellSize:function(){if(!e._getCellSize){a("body").append(a('<div style="display: none; position: absolute;" class="fn-gantt" id="measureCellWidth"><div class="row"></div></div>'));e._getCellSize=a("#measureCellWidth .row").height();a("#measureCellWidth").empty().remove()}return e._getCellSize},getRightPanelSize:function(){a("body").append(a('<div style="display: none; position: absolute;" class="fn-gantt" id="measureCellWidth"><div class="rightPanel"></div></div>'));var h=a("#measureCellWidth .rightPanel").height();a("#measureCellWidth").empty().remove();return h},getPageHeight:function(h){return h.pageNum+1===h.pageCount?h.rowsOnLastPage*e.getCellSize():d.itemsPerPage*e.getCellSize()},_getProgressBarMargin:null,getProgressBarMargin:function(){if(!e._getProgressBarMargin){a("body").append(a('<div style="display: none; position: absolute;" id="measureBarWidth" ><div class="fn-gantt"><div class="rightPanel"><div class="dataPanel"><div class="row day"><div class="bar" /></div></div></div></div></div>'));e._getProgressBarMargin=parseInt(a("#measureBarWidth .fn-gantt .rightPanel .day .bar").css("margin-left").replace("px",""),10);e._getProgressBarMargin+=parseInt(a("#measureBarWidth .fn-gantt .rightPanel .day .bar").css("margin-right").replace("px",""),10);a("#measureBarWidth").empty().remove()}return e._getProgressBarMargin}};this.each(function(){if(c){a.extend(d,c)}this.data=null;this.pageNum=0;this.pageCount=0;this.rowsOnLastPage=0;this.rowsNum=0;this.hPosition=0;this.dateStart=null;this.dateEnd=null;this.scrollClicked=false;this.scaleOldWidth=null;this.headerRows=null;if(d.useCookie){var h=a.cookie(this.cookieKey+"CurrentScale");if(h){d.scale=a.cookie(this.cookieKey+"CurrentScale")}else{a.cookie(this.cookieKey+"CurrentScale",d.scale)}}switch(d.scale){case"hours":this.headerRows=3;this.scaleStep=1;break;case"weeks":this.headerRows=3;this.scaleStep=13;break;case"months":this.headerRows=2;this.scaleStep=14;break;default:this.headerRows=3;this.scaleStep=13;break}this.scrollNavigation={panelMouseDown:false,scrollerMouseDown:false,mouseX:null,panelMargin:0,repositionDelay:0,panelMaxPos:0,canScroll:true};this.gantt=null;this.loader=null;b.create(this)})}})(jQuery);